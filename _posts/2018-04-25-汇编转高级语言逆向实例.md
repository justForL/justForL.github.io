---
title: æ±‡ç¼–è½¬é«˜çº§è¯­è¨€é€†å‘å®ä¾‹

layout: post

tags: é€†å‘

---

## ç¼–å†™ç®€å•çš„å‡½æ•°ç”¨äºé€†å‘åˆ†æ
> å­¦ä¹ éœ€è¦å¾ªåºæ¸è¿›ğŸ˜†,å…ˆæ¥ä¸€æ®µç®€å•çš„æ±‚å’Œå‡½æ•°,è¿è¡Œå,å¯ä»¥æ­£å¸¸æ‰“å°ç»“æœ,

* ç¼–å†™æ±‚å’Œå‡½æ•°
	![](https://ws4.sinaimg.cn/large/006tNc79ly1fqorl7pqchj31kw11r7cg.jpg)

> å¦‚ä¸‹æ˜¯è¿›å…¥sumå‡½æ•°çš„æ±‡ç¼–ä»£ç 

```assembly

->  0x100716880 <+0>:  sub    sp, sp, #0x10             ; =0x10 
    0x100716884 <+4>:  adrp   x8, 2
    0x100716888 <+8>:  add    x8, x8, #0xd10            ; =0xd10 
    0x10071688c <+12>: str    w0, [sp, #0xc]
    0x100716890 <+16>: str    w1, [sp, #0x8]
    0x100716894 <+20>: ldr    w0, [x8]
    0x100716898 <+24>: ldr    w1, [sp, #0x8]
    0x10071689c <+28>: add    w0, w0, w1
    0x1007168a0 <+32>: str    w0, [sp, #0x4]
    0x1007168a4 <+36>: ldr    w0, [sp, #0x4]
    0x1007168a8 <+40>: ldr    w1, [sp, #0xc]
    0x1007168ac <+44>: add    w0, w0, w1
    0x1007168b0 <+48>: add    sp, sp, #0x10             ; =0x10 
    0x1007168b4 <+52>: ret    


```
## åˆ©ç”¨idaProè¿›è¡Œåç¼–è¯‘
* æ‰“å¼€é¡¹ç›®ä¸­çš„productsæ–‡ä»¶å¤¹,æ‰¾åˆ°ç¼–è¯‘åçš„é¡¹ç›®åœ¨finderä¸­æ‰“å¼€

	![](https://ws1.sinaimg.cn/large/006tNc79ly1fqort5gunkj317e14o7ip.jpg)
	
* å³é”®é¡¹ç›®æ–‡ä»¶,æ˜¾ç¤ºåŒ…å†…å®¹,è¿™ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦å·¥å…·æŸ¥çœ‹æ±‡ç¼–ä»£ç çš„æ–‡ä»¶

	![](https://ws1.sinaimg.cn/large/006tNc79ly1fqoruxa0awj31160myaej.jpg)

* æ¥ä¸‹æ¥å°±ç”¨åˆ°ä¸»è§’idaPro![](https://ws2.sinaimg.cn/large/006tNc79ly1fqorzsto0yj308s086wgn.jpg)
* æ‰“å¼€idaProå,æ‹–å…¥åˆšåˆšçš„é¡¹ç›®æ–‡ä»¶,åˆ›å»ºæ–°çš„å·¥ç¨‹,åŠ è½½å®Œæˆåå³å¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢,æ•²å‡»ç©ºæ ¼å,å³å¯çœ‹åˆ°ä»£ç 

	![](https://ws1.sinaimg.cn/large/006tNc79ly1fqos27qnznj31kw0wx14i.jpg)
	
	![](https://ws3.sinaimg.cn/large/006tNc79ly1fqos3qczhaj31kw0ww4e6.jpg)

* åœ¨çœ‹æ±‡ç¼–ä»£ç çš„æ—¶å€™,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬åšäº†ä¸€äº›æ“ä½œ:
	* æ‹‰ä¼¸æ ˆç©ºé—´
	* å°†å‚æ•°å…¥æ ˆ
	* blè¿›å…¥æˆ‘ä»¬ç¼–å†™çš„sumå‡½æ•°
	
	![](https://ws2.sinaimg.cn/large/006tNc79ly1fqos8ttkxwj31kw0qy4lv.jpg)

* åŒå‡»sumå‡½æ•°è·³è¿›å¯¹åº”çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹å›¾,å’Œæˆ‘ä»¬åœ¨ç¼–è¯‘å™¨é‡Œçœ‹åˆ°çš„æŒ‡ä»¤æ“ä½œæ˜¯ä¸€æ ·ä¸€æ ·çš„,å“ˆå“ˆå“ˆ,æ¥ä¸‹æ¥æˆ‘ä»¬è¯•ç€è¿˜åŸé«˜çº§è¯­è¨€çš„ä»£ç 
	![](https://ws3.sinaimg.cn/large/006tNc79ly1fqosbzczzwj30y00cedjk.jpg)
	
## è¿˜åŸé«˜çº§ä»£ç 
åœ¨idaä¸­å°†éœ€è¦è¿˜åŸçš„æ±‡ç¼–ä»£ç ç²˜è´´åˆ°ä»»æ„çš„ç¼–è¾‘å™¨å†…,æˆ‘è¿™é‡Œå°±ä»¥sublimeä¸ºä¾‹,ç”¨å•¥éƒ½è¡ŒğŸ˜†

* åœ¨è®°äº‹æœ¬é‡Œæ–°å»ºä¸€ä¸ªå‡½æ•°,æ— å‚æ— è¿”å›å€¼,æ ¹æ®æ±‡ç¼–ä»£ç ä¸€ç‚¹ä¸€ç‚¹è¿˜åŸä¿®æ”¹å³å¯

	![](https://ws4.sinaimg.cn/large/006tNc79ly1fqoshvqujcj31bc0smgr5.jpg)

> æ¥ä¸‹æ¥æ˜¯è¦åˆ†æ®µ,æ ¹æ®å‰é¢æ‰€æŒæ¡çš„çŸ¥è¯†,æŠŠè¯­å¥åˆ†æ®µ,å°†å¤æ‚çš„æ´»åŠ¨åˆ†å‰²,é€ä¸ªå‡»ç ´ğŸ˜†


![](https://ws3.sinaimg.cn/large/006tNc79ly1fqow42gb2hj31kw0zjgvn.jpg)

ç„¶åå°±æ˜¯æ ¹æ®æ±‡ç¼–ä»£ç è¿›è¡Œè¿˜åŸ


```c

void * global;

void function() {
// æ ‡è¯†å‡½æ•°å¼€å§‹çš„åœ°æ–¹
// __text:0000000100006880 _sum                                    ; CODE XREF: _main+28â†“p
// __text:0000000100006880			å·¥å…·æ›¿æˆ‘ä»¬ç”Ÿæˆçš„åŠ©è®°ç¬¦,å…ˆä¸ç”¨åŠ¨
// __text:0000000100006880 var_C           = -0xC
// __text:0000000100006880 var_8           = -8
// __text:0000000100006880 var_4           = -4
// __text:0000000100006880

	int w0,w1;
				//æ‹‰ä¼¸æ ˆæ§ä»¶
// __text:0000000100006880                 SUB             SP, SP, #0x10

				//ADRP  +   ADD   ä¸€èˆ¬è¿™ä¸¤å¥åŒæ—¶å‡ºç°çš„æ—¶å€™,è¦ç»“åˆç€çœ‹,   æ—¨åœ¨å»å¸¸é‡åŒºæˆ–è€…å…¨å±€åŒº å–å€¼    
// __text:0000000100006884                 ADRP            X8, #_global@PAGE
// __text:0000000100006888                 ADD             X8, X8, #_global@PAGEOFF

				//å°†å‚æ•°w0å…¥æ ˆ
// __text:000000010000688C                 STR             W0, [SP,#0x10+var_4]
	int var_4 = w0;
				//å°†å‚æ•°w1å…¥æ ˆ
// __text:0000000100006890                 STR             W1, [SP,#0x10+var_8]
	int var_8 = w1
				//å°†x8çš„æ•°æ®å­˜å…¥åˆ°w0å¯„å­˜å™¨     x8ç°åœ¨æ˜¯globalçš„å€¼
// __text:0000000100006894                 LDR             W0, [X8]
	w0 = global;
				//å°†var_8çš„å€¼å­˜å…¥åˆ°w1å¯„å­˜å™¨   var_8çš„å€¼ æ˜¯w1çš„å‚æ•°
// __text:0000000100006898                 LDR             W1, [SP,#0x10+var_8]
	w1 = var_8;

//				å°†woä¸w1ç›¸åŠ  èµ‹å€¼åˆ°w0ä¸­    ç›¸å½“äºglobal+w1
// __text:000000010000689C                 ADD             W0, W0, W1
	w0 = w0 + w1;

//					å°†w0çš„å€¼å…¥æ ˆä¿æŠ¤
// __text:00000001000068A0                 STR             W0, [SP,#0x10+var_C]
	int var_C = w0;

			//  	w0 å‡ºæ ˆ
// __text:00000001000068A4                 LDR             W0, [SP,#0x10+var_C]
	w0 = var_C;
			//å°†å‚æ•°1å‡ºæ ˆåˆ°w1 ä¸­
// __text:00000001000068A8                 LDR             W1, [SP,#0x10+var_4]
	w1 = var_4;
	//w0 + w1 èµ‹å€¼åˆ°  w0
// __text:00000001000068AC                 ADD             W0, W0, W1
	w0 += w1;

//æ ˆå¹³è¡¡
// __text:00000001000068B0                 ADD             SP, SP, #0x10
// __text:00000001000068B4                 RET

}

```

> ç°åœ¨è¿˜æ˜¯ä¸å¤ªå¥½çœ‹å‡ºé€»è¾‘,æˆ‘ä»¬å¯ä»¥ä»åå‘å‰é€†æ¨æ¥ä¼˜åŒ–é€»è¾‘

```c

int global;
int function(int a, int b) {
// æ ‡è¯†å‡½æ•°å¼€å§‹çš„åœ°æ–¹
// __text:0000000100006880 _sum                                    ; CODE XREF: _main+28â†“p
// __text:0000000100006880			å·¥å…·æ›¿æˆ‘ä»¬ç”Ÿæˆçš„åŠ©è®°ç¬¦,å…ˆä¸ç”¨åŠ¨
// __text:0000000100006880 var_C           = -0xC
// __text:0000000100006880 var_8           = -8
// __text:0000000100006880 var_4           = -4
// __text:0000000100006880

	int w0 = a,w1 = b;

	w0 = global + w1 + w0;

//æ ˆå¹³è¡¡
// __text:00000001000068B0                 ADD             SP, SP, #0x10
// __text:00000001000068B4                 RET

}

```

> æ­¤æ—¶å·²ç»å¯ä»¥å¼€å‡ºé€»è¾‘äº†,å°±æ˜¯ç®€å•çš„w0+w1+globalğŸ˜­,æˆ‘ä»¬ä»mainå‡½æ•°å¯ä»¥çœ‹åˆ°,x0,x1ç©¿å…¥äº†ä¸¤ä¸ªå‚æ•°,æ‰€ä»¥è¦æ”¹å˜functionçš„å‡½æ•°å½¢å¼å‚æ•°,å‡½æ•°çš„æœ€åå°†ç´¯åŠ çš„å€¼æ”¾åˆ°äº†w0,è¯´æ˜ä¹Ÿæœ‰è¿”å›å€¼,åœ¨æ•´ä¸ªå‡½æ•°ä¸­,globalå‚ä¸äº†è¿ç®—,æ‰€ä»¥æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡,æˆ‘ä»¬çŒœæµ‹æ˜¯ä¸€ä¸ªintç±»å‹çš„å€¼,ç»¼ä¸Šåˆ†æ,å‡½æ•°å°±åŸºæœ¬è¿˜åŸäº†.

**æ³¨æ„:**globalæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡,åœ¨ç¼–è¯‘å™¨ç¼–è¯‘çš„æ—¶å€™,å°±åœ¨å†…å­˜çš„å…¨å±€åŒºä¸ºå®ƒæ‰¾åˆ°äº†å­˜å‚¨åŒºåŸŸ,æˆ‘ä»¬åœ¨é€†å‘çš„è¿‡ç¨‹ä¸­æ˜¯æ‹¿ä¸åˆ°å…·ä½“çš„å€¼çš„,ä½†æˆ‘ä»¬çŸ¥é“adrpçš„å­˜å‚¨ç‰¹æ€§çš„è¯,æˆ‘ä»¬å°±å¯ä»¥æœ‰çš„æ”¾çŸ¢çš„å»çŒœæµ‹(**4kåŒºåŸŸ,åç§»12ä½**)

## Demo

[Demo](https://github.com/justForL/ReverseToHeighLangrage)