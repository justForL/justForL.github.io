---
title: é‡ç­¾å

layout: post

tags: æ±‡ç¼–

---

## è¿˜åŸappç­¾åè¿‡ç¨‹

åœ¨æ—¥å¸¸å¼€å‘ä¸­,æˆ‘ä»¬æœ€ç¦»ä¸å¼€çš„å°±æ˜¯è‹¹æœçš„ç­¾åè¯ä¹¦,æ¨é€éœ€è¦ç”¨åˆ°,ä¸Šæ¶éœ€è¦ç”¨åˆ°,çœŸæœºè°ƒè¯•.....ä¸€ç›´ä»¥æ¥å°±æ˜¯æœºæ¢°åŒ–çš„æ“ä½œ,ä»è¯ä¹¦åŠ©æ‰‹å¯¼å‡º,ä¸Šä¼ developer,é…ç½®è¯ä¹¦,ä¸‹è½½è¯ä¹¦....æ²¡æƒ³è¿‡ä¸ºä»€ä¹ˆ,ä»å¼€å§‹å­¦ä¹ é€†å‘å¼€å§‹,æ‰å®äº†å¾ˆå¤šåŸæ¥æ²¡æœ‰æ·±äº†è§£çš„çŸ¥è¯†ğŸ˜†,ç­¾åè¿‡ç¨‹å¦‚ä¸‹å›¾:
![](https://ws2.sinaimg.cn/large/006tKfTcly1fr3oypli2wj315a166diz.jpg)
<center>ç­¾åè¿‡ç¨‹</center>

æ¥ä¸‹æ¥æˆ‘ä»¬ä»”ç»†çš„æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹:

> ç”±äºiphoneçš„è½¯ç¡¬ä»¶éƒ½æ˜¯è‹¹æœè‡ªå·±çš„,åœ¨iphoneå‡ºå‚çš„æ—¶å€™å°±æŠŠå…¬é’¥æ”¾åˆ°äº†è‹¹æœæ‰‹æœºå†…éƒ¨,ç§é’¥å­˜æ”¾åœ¨è‹¹æœçš„æœåŠ¡å™¨ä¸­,è¿™æ˜¯å‰ç½®æ¡ä»¶ğŸ˜†

* åœ¨æˆ‘ä»¬çš„macç”µè„‘ä¸Šç”Ÿæˆç§é’¥,æ ¹æ®ç§é’¥ç®—å‡ºå…¬é’¥,å¤ä¹ ä¸‹å‘½ä»¤
	* $ openssl genrsa -out privateKey.pem 512
	* $ openssl rsa - in privateKey.pem -out public.pem -pubout
* è®²æˆ‘ä»¬åœ¨macä¸Šç®—å‡ºçš„å…¬é’¥å‘é€ç»™è‹¹æœ,è‹¹æœåˆ©ç”¨åå°å­˜æ”¾çš„ç§é’¥Aå¯¹macä¸Šä¼ çš„å…¬é’¥è¿›è¡Œhash,ç”Ÿæˆç­¾åè¯ä¹¦å†å›ä¼ ç»™æˆ‘ä»¬
* æˆ‘ä»¬åœ¨å¼€å‘ç”µè„‘ä¸Šç”¨æœ¬åœ°ç§é’¥,å¯¹æˆ‘ä»¬çš„APPä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„MachOæ–‡ä»¶è¿›è¡Œç­¾å(ä¹Ÿå°±æ˜¯å°†ç§é’¥å’Œè‹¹æœä¸‹å‘çš„è¯ä¹¦æ–‡ä»¶ä¸€èµ·æ‰“åŒ…è¿›Appæ–‡ä»¶ä¸­)å¹¶ä¼ è¾“åˆ°æ‰‹æœºä¸Š
* åœ¨æ‰‹æœºä¸­,é¦–å…ˆå…ˆç”¨macæœ¬åœ°çš„ç§é’¥å¯¹è¯ä¹¦å…¬é’¥è¿›è¡Œè§£å¯†,éªŒè¯æ˜¯è‹¹æœéªŒè¯è¿‡çš„å…¬é’¥å,ç”¨iphoneæœ¬åœ°çš„ç§é’¥åœ¨å¯¹è¯ä¹¦æ–‡ä»¶ä¸­ç­¾åè¿‡çš„è¯ä¹¦hashè¿›è¡Œè§£å¯†,è¿˜åŸå…¬é’¥,å½“è¿˜åŸå…¬é’¥æ¯”å¯¹ä¸€è‡´å,è¯´æ˜è¿™ä¸ªappæ˜¯é€šè¿‡ç­¾åéªŒè¯çš„

> è‹¹æœè¿›è¡Œé‡Œä¸¤æ¬¡ç­¾åéªŒè¯,ä¿è¯äº†å®‰å…¨æ€§,å¯æ˜¯è¿™æ ·åˆå¸¦æ¥äº†å¦å¤–ä¸€ä¸ªé—®é¢˜,å°±æ˜¯å®‰è£…èŒƒå›´çš„é—®é¢˜,ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,è‹¹æœåˆé€€å‡ºäº†ppæ–‡ä»¶(mobileprovisionProfile),æ¥æ ‡è¯†è¿™ä¸ªappçš„å®‰è£…è®¾å¤‡,ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å¼€å‘è€…ç½‘ç«™ä¸Šéœ€è¦å°†è°ƒè¯•è®¾å¤‡æ·»åŠ åˆ°ppæ–‡ä»¶ä¸­,è¿™ä¸ªå°±ä¸ä¸€ä¸€èµ˜è¿°äº†

## æ‰‹åŠ¨ç­¾åapp
é¦–å…ˆæˆ‘ä»¬è¦å…ˆæ‰¾åˆ°ä¸‹è½½çš„ç ¸å£³åçš„appåŒ…

![](https://ws4.sinaimg.cn/large/006tKfTcly1fr499y5nxuj316s0oajwy.jpg)

åˆ©ç”¨codeSignå·¥å…·æŸ¥çœ‹å®ƒçš„ç­¾åä¿¡æ¯

```c
$ codesign -vv -d WeChat

```
![](https://ws1.sinaimg.cn/large/006tKfTcly1fr49f0j92lj30vk0qstf9.jpg)

æŸ¥çœ‹æè¿°æ–‡ä»¶ä¿¡æ¯:

```c
$ security cms -D -i 

```
æŸ¥çœ‹æœ¬æœºæ‰€æœ‰çš„è¯ä¹¦å‘½ä»¤:

```c
$ security find-identity -v -p codesigning

```

æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„åŠ å¯†ä¿¡æ¯:

```c
$ otool -l WeChat | grep crypt

```
![](https://ws3.sinaimg.cn/large/006tKfTcly1fr49oilakpj30vm0qatdd.jpg)


> åœ¨åšé‡ç­¾åçš„æ—¶å€™,çœ‹åˆ°PlugIns,watchæ–‡ä»¶å¤¹ç›´æ¥æ€æ‰å°±å¥½,å› ä¸ºæˆ‘ä»¬è‡ªå·±ç­¾åçš„æ—¶å€™,è¿™äº›æ‹“å±•åŒ…æ˜¯æ— æ³•å¯¹é½ç­¾åçš„

* åˆ é™¤PlugIns,Watchæ–‡ä»¶å¤¹
* å¯¹frameworkæ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶è¿›è¡Œç­¾å,æ˜¾ç¤ºå¦‚ä¸‹è¯´æ˜ç­¾åæˆåŠŸ

```c
$ codesign -fs "iPhone Developer: 2032251@qq.com (8893ZGY7RR)" MultiMedia.framework
```
![](https://ws2.sinaimg.cn/large/006tKfTcly1fr49yh95xtj31go0w6n9w.jpg)

* ç»™å¯æ‰§è¡Œæ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™

```c
$ chmod +x WeChat
```

* æè¿°æ–‡ä»¶æ›¿æ¢è®²xcodeé¡¹ç›®ä¸­çš„appæ–‡ä»¶ä¸­çš„embedded.mobileprovisionæ–‡ä»¶æ‹·è´åˆ°WeChatç›®å½•ä¸‹
* è®²wechatåŒ…å†…çš„bundleIdæ”¹æˆæˆ‘ä»¬çš„é¡¹ç›®çš„bundleId
* æ‹·è´wechatçš„æƒé™æ–‡ä»¶åˆ°wechatçš„æ ¹ç›®å½•ä¸­
![](https://ws3.sinaimg.cn/large/006tKfTcly1fr4aovo6uvj30vg0qqq91.jpg)
* ç­¾åæ•´ä¸ªapp

```c
$ codesign -fs "iPhone Developer: 2032251@qq.com (8893ZGY7RR)" --no-strict --entitlements=en.plist WeChat.app
```
![](https://ws1.sinaimg.cn/large/006tKfTcly1fr4azb33uqj30vg05e75y.jpg)

* å¯¹payloadæ‰“åŒ…

```c
$ zip -ry WeChat.ipa Payload
```

ç­¾åå,åˆ©ç”¨xcodeä¸­çš„çœŸæœºå®‰è£…,å¦¥å¦¥çš„å®‰è£…å“¦ğŸ˜†
## XCodeè‡ªåŠ¨ç­¾åapp

## shellè„šæœ¬è‡ªåŠ¨åŒ–ç­¾åè„šæœ¬
